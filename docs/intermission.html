<!-- LTeX: enabled=false -->
<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Reveal.js Auto-Advancing Slideshow</title>
        <link rel="stylesheet" href="../dist/reveal.css">
        <link rel="stylesheet" href="../dist/theme/black.css" id="theme">
        <style>
            <link rel="stylesheet" href="../dist/reveal.css">
            <link rel="stylesheet" href="../dist/theme/black.css" id="theme">
            body {
                background-color: #00d298;

            }
            table.schedule-table {
                font-size: 12pt;
                width: 100%;
                margin: 0 auto;
                border-collapse: collapse;
                text-decoration: none;
            }

        </style>
    </head>
    <body>
        <script src="../dist/reveal.js"></script>
		<script src="../plugin/notes/notes.js"></script>
		<script src="../plugin/markdown/markdown.js"></script>
		<script src="../plugin/highlight/highlight.js"></script>
        <div class="reveal">
            <div class="slides">
                <section
                    data-background-color=#00d298
                    data-background-image="https://www.elbsides.eu/assets/2025/logos/Elbsides%202025%20strong%20lines%20animated.svg"
                    data-background-position="top right"
                    data-background-size="20%">
                    <h2>Slide 1</h2>
                    <p>This slide auto-advances every 5 seconds.</p>
                </section>
                <section id="schedule"
                    data-background-color=#00d298
                    data-background-image="https://www.elbsides.eu/assets/2025/logos/Elbsides%202025%20strong%20lines%20animated.svg"
                    data-background-position="top right"
                    data-background-size="20%"
                    >
                </section>
                <section
                    data-background-color=#00d298
                    data-background-image="https://www.elbsides.eu/assets/2025/logos/Elbsides%202025%20strong%20lines%20animated.svg"
                    data-background-position="top right"
                    data-background-size="20%">
                    <h2>Slide 3</h2>
                    <p>And so does this slide.</p>
                </section>
            </div>
        </div>
        <script>
            Reveal.initialize({
                transition: 'fade',
                autoSlide: 5000, // time in ms between slides
                autoSlideStoppable: false, // prevent stopping on user input
                loop: true
            });
        </script>
        <script>
            // Function to format time in HH:MM format
            function formatTime(dateString) {
                const date = new Date(dateString);
                return date.toTimeString().substring(0, 5);
            }

            // Function to create schedule from JSON data
            function createSchedule(data) {
                const days = data.schedule.conference.days;
                let scheduleHTML = '<h2>Schedule Overview</h2>';

                // Create a table for each day
                days.forEach(day => {
                    // scheduleHTML += `<h3>${new Date(day.day_start).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}</h3>`;
                    scheduleHTML += '<table class="schedule-table">';
                    scheduleHTML += '<tr><th>Time</th><th>Speaker</th><th>Title</th></tr>';

                    // Process all rooms/tracks for the day
                    Object.keys(day.rooms).forEach(room => {
                        // Only process events for Elbkuppel room
                        if (room !== "Elbkuppel") {
                            return;
                        }
                        const events = day.rooms[room];
                        let lastTime = null;
                        events.forEach(event => {
                            const startTime = event.start;
                            const start = new Date(event.start);
                            const duration = new Date(event.duration)
                            const [startM, startS] = event.start.split(':').map(Number);
                            const [durM, durS] = event.duration.split(':').map(Number);
                            const totalSeconds = startM * 60 + startS + durM * 60 + durS;
                            const endM = Math.floor(totalSeconds / 60);
                            const endS = totalSeconds % 60;
                            const endTime = `${endM.toString().padStart(2, '0')}:${endS.toString().padStart(2, '0')}`;
                            console.log(`Start: ${startTime}, Duration: ${event.duration}, End: ${endTime}`);
                            const title = event.title;
                            const persons = event.persons.map(person => person.public_name).join(', ');
                            if (lastTime && lastTime !== startTime) {
                                scheduleHTML += `<tr>
                                    <td>${lastTime}</td>
                                    <td>-</td>
                                    <td>break</td>
                                </tr>`;
                            }
                            scheduleHTML += `<tr>
                                <td>${startTime}</td>
                                <td>${persons}</td>
                                <td>${title}</td>
                            </tr>`;

                            lastTime = endTime;
                        });
                    });
                    scheduleHTML += '</table>';
                });

                document.getElementById('schedule').innerHTML = scheduleHTML;
            }

            // Fetch and process the schedule data
            fetch('https://pretalx.com/elbsides-2025/schedule/export/schedule.json')
                .then(response => response.json())
                .then(data => createSchedule(data))
                .catch(error => {
                    console.error('Error loading schedule:', error);
                    document.getElementById('schedule-content').innerHTML = 'Unable to load schedule data.';
                });
        </script>
    </body>
</html>
